## Longitudinal consistency of base tree topology
**(on right)** A tree of tumor progression reported in Figure 3 in the main text of the `DETOPT` manuscript is shown (see the caption in the main text for the description of node and edge labels and see below for the description of coloring of tree nodes). Sequencing data used to build the tree were obtained from 18 samples taken at four different time points (212 days before and 81, 342 and 523 days after treatment) and from distinct metastases. These time points are associated with different colors as shown in the figure. **(on left)** A heatmap shows the inferred cellular prevalence values of mutations assigned to a given subclone/node in a given sample. For example, the value for subclone/row 14 in sample/column 4435-2Met_FrTu is equal to 0.48, indicating that in sample 4435-2Met_FrTu, mutations that occur for the first time at subclone/node 14 are present in 48 percent of cells. On the other hand, the value of node/subclone 5 for the same sample is 0 indicating that mutations occurring for the first time at node/subclone 5 are absent from this sample. Each node of the tree was colored in the color of the time points at which mutations assigned to that node were first observed. For example, the color of node 4 matches the color of sampling done 81 days after treatment. Looking into the heatmap, we can observe that mutations assigned to this node were absent in all samples sampled at the first timepoint, whereas among the samples sampled (we should change this expression "samples sampled") at the second timepoint these mutations were present in sample 111e6e61e1Met-2_FrTu at a frequency of 27% (note that the absence of these mutations in the other sample obtained at this timepoint 111e6e61e1Met_FrTu is most likely due to intratumoral heterogeneity and absence of this subclone in this sample). Here, we have grouped and ordered subclones such that the ancestor-descendant relationships in the base tree are represented as best as possible [^2]. As it can be seen, the order of the subclones in the tree is consistent with the chronological order in which samples were obtained. For any pair of subclones, a subclone that has mutations specific to it, and that are present for the first time only in sample(s) from a later time point, is always a descendant of a subclone that has mutations specific to it, which are present for the first time at earlier time points (here, by mutations specific to a subclone we refer to the set of mutations that appear for the first time at that subclone). The raw `.tsv` file for the heatmap can be download [here](demo_outputs/4355_dcf_table.tsv).

<p align="center">
  <img src="https://github.com/algo-cancer/DETOPT/blob/main/real_data/demo/demo_outputs/4355_dcf.png" width="400" height="750">
  <img src="https://github.com/algo-cancer/DETOPT/blob/main/real_data/demo/demo_outputs/base_tree_sampling_times.png" width="380" height="750">
</p>